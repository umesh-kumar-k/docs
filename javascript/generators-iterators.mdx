# JavaScript Generators & Iterators - **DETAILED** Pausable Functions

**Generators** (`function*`) return **iterators** with **`next()`** control. **`yield`** pauses ‚Üí **`next(value)`** resumes + passes data. **Lazy evaluation** - values computed **on-demand**. **`yield*`** delegates to sub-iterators.[1]

## **DETAILED Section-wise Breakdown**

### **1. Generator Functions vs Normal (Run-to-Completion)**

**Normal Function:**
```javascript
function normal() {
  console.log(1);
  console.log(2);
  console.log(3);  // Always runs fully
}
normal();  // 1‚Üí2‚Üí3 (unstoppable)
```

**Generator Function (`function*`):**
```javascript
function* gen() {
  console.log('start');
  yield '‚ú®';
  console.log('continue');
  yield 'üíï';
  return 'Done!';
}
const it = gen();  // Returns ITERATOR object
```

**Iterator Protocol:**
```
it.next() ‚Üí {value: '‚ú®', done: false}
it.next() ‚Üí {value: 'üíï', done: false} 
it.next() ‚Üí {value: 'Done!', done: true}
it.next() ‚Üí {value: undefined, done: true}  // CLOSED
```

### **2. Generator Object Anatomy**

**Returned Object Properties:**
| Property | Purpose |
|----------|---------|
| **`next(arg)`** | **Resume** + pass `arg` to `yield` |
| **`[Symbol.iterator]`** | **Iterable** protocol |
| **Internal State** | **Pauses** at `yield` lines |

**State Machine Visual:**
```
gen() ‚Üí Iterator { next: fn, [Symbol.iterator]: self }
it.next() ‚Üí yield '‚ú®' (PAUSE)
it.next('input') ‚Üí Receives 'input' as yield value ‚Üí yield 'üíï'
```

### **3. Bidirectional Data Flow**

**Observer Pattern:**
```javascript
function* observer() {
  const firstInput = yield 'First!';    // Waits for input
  console.log('Received:', firstInput);
  const secondInput = yield 'Second!';  // Waits again
  return secondInput;
}

const it = observer();
it.next();           // {value: 'First!', done: false}
it.next('JS');       // Logs "Received: JS" ‚Üí {value: 'Second!', done: false}
it.next('Love!');    // Returns "Love!"
```

### **4. Iterator Protocol (`[Symbol.iterator]`)**

**Iterable Check:**
```javascript
[1,2,3][Symbol.iterator]  // Iterator fn
'abc'[Symbol.iterator]    // Iterator fn
{ a: 1 }[Symbol.iterator] // undefined (NOT iterable)
```

**Make Iterable:**
```javascript
const obj = { data: [1,2,3] };
obj[Symbol.iterator] = function*() {
  yield* this.data;  // Delegate
};
[...obj];  // [1,2,3]
```

### **5. `yield*` Delegation**

**Flatten Iterators:**
```javascript
function* keys(obj) {
  yield* Object.keys(obj);  // Yields each key individually
}
const obj = {a:1,b:2};
[...keys(obj)];  // ['a','b'] NOT [['a','b']]
```

**Nested Generators:**
```
iterateClubs* ‚Üí yield* iterateMembers* ‚Üí yield* iterateBooks*
```

### **6. Lazy Evaluation (Key Use Case)**

**Book Search (No Full Traversal):**
```javascript
function* iterateBooks(books) { yield* books; }
function* iterateMembers(members) { 
  for (const member of members) yield* iterateBooks(member.books); 
}
function* iterateClubs(clubs) { 
  for (const club of clubs) yield* iterateMembers(club.clubMembers); 
}

function findBook(clubs, id) {
  for (const book of iterateClubs(clubs)) {
    if (book.id === id) return book;  // STOP EARLY
  }
}
```

**vs Traditional:**
```javascript
// ‚ùå Loads ALL data into memory
const allBooks = clubs.flatMap(c => 
  c.clubMembers.flatMap(m => m.books)
);
return allBooks.find(b => b.id === id);
```

## Key Classes/Interfaces

| Method/Property | Generator Object | Returns |
|-----------------|------------------|---------|
| **`next(value?)`** | Resume + input | `{value: any, done: boolean}` |
| **`[Symbol.iterator]`** | Self-reference | Iterator |
| **`yield`** | **Pause point** | Pauses execution |
| **`yield*`** | **Delegation** | Flattens sub-iterators |
| **`done: true`** | **Terminal state** | After `return` |

## Design Patterns

**1. Search/Filtering (Early Exit):**
```javascript
function* streamSearch(stream, query) {
  for await (const chunk of stream) {
    const match = chunk.includes(query);
    if (match) return match;  // No full scan
    yield chunk;
  }
}
```

**2. Nested Iteration:**
```javascript
function* flattenDeep(nested) {
  for (const item of nested) {
    if (item[Symbol.iterator]) yield* flattenDeep(item);
    else yield item;
  }
}
```

## Best Practices

| Practice | ‚úÖ Why |
|----------|--------|
| **`yield*` for arrays** | Flattens naturally |
| **Single iteration** | `done: true` ‚Üí closed forever |
| **Error handling** | `try/yield/catch` works |
| **Lazy consumers** | `for await...of` backpressure |

**Avoid:**
```javascript
// ‚ùå Multiple iterators
const it1 = gen();
const it2 = gen(it1.next());  // WRONG
```

## Advanced Topics

**Two-way Communication:**
```javascript
function* pingPong() {
  let count = 0;
  while (count < 3) {
    const input = yield count++;  // Output ‚Üí input
    console.log('Received:', input);
  }
}
```

**Generator Delegation Trees:**
```
top* ‚Üí yield* level1* ‚Üí yield* level2* ‚Üí yield value
```

## Interview Cheat Sheet (Q&A)

**Q: `function*` returns what?**  
A: **Generator object** (iterator) - **NOT** executes immediately[1]

**Q: `it.next()` vs `it.next('data')`?**  
A: **First**: Starts ‚Üí `yield`; **Second**: **`yield` receives `'data'`** ‚Üí next `yield`

**Q: Generator state after `done: true`?**  
A: **Closed forever** - `next()` ‚Üí `{value: undefined, done: true}`

**Q: `yield*` vs `yield`?**  
A: **`yield*`**: **Flattens iterator**; `yield [1,2]` ‚Üí `[[1,2]]`

**Q: Make object iterable?**  
A: `obj[Symbol.iterator] = function*() { yield* obj.data; }`

**Q: Lazy evaluation benefit?**  
A: **On-demand computation** - stop early, memory efficient

## Important Terms & Keywords

**Core:**
- **`function*`** - Generator declaration
- **`yield`** - **Pause** + output value
- **`next(value)`** - **Resume** + input to `yield`
- **`{value, done}`** - Iterator result format

**Protocols:**
- **`[Symbol.iterator]`** - Returns iterator
- **Iterator Protocol** - `next()` method required

**Advanced:**
- **`yield*`** - **Delegate/flatten** sub-iterators
- **`done: true`** - Generator **closed** (post-return)
- **Lazy Evaluation** - Values computed **on-demand**
- **Run-to-completion** - Normal functions (no pause)[1]

[1](https://dev.to/lydiahallie/javascript-visualized-generators-and-iterators-e36)